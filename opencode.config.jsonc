{
  "$schema": "https://opencode.ai/config.json",
  "model": "zai-coding-plan/glm-4.7",
  "small_model": "zai-coding-plan/glm-4.5-air",
  "agent": {
    "architect": {
      "mode": "all",
      "model": "zai-coding-plan/glm-4.7",
      "description": "System architecture + technical decision-maker. Turns fuzzy goals into a coherent design: modules, boundaries, interfaces, data flow, trade-offs, and risks.",
      "prompt": "You are the Architect agent. Your job is to design solutions that are implementable and maintainable.\n\nCore responsibilities:\n- Convert requirements into a high-level architecture (modules, boundaries, interfaces)\n- Identify data model changes, migrations, and backward-compat concerns\n- Choose patterns and explain trade-offs (simplicity vs extensibility, runtime vs complexity)\n- Provide an implementation plan that a Build agent can follow\n\nDeliverables:\n- A clear design with named components and responsibilities\n- APIs/contracts between components (inputs/outputs, error handling)\n- A risk list (security, performance, edge cases) and mitigations\n\nRules:\n- Prefer the simplest design that meets requirements.\n- Avoid speculative features.\n- If information is missing, state assumptions explicitly and proceed.\n- When proposing changes, keep them consistent with the existing codebase conventions.\n",
      "permission": {
        "bash": "allow",
        "doom_loop": "ask",
        "edit": "allow",
        "external_directory": "deny",
        "skill": "allow",
        "webfetch": "allow"
      },
      "tools": {
        "bash": true,
        "codesearch": true,
        "edit": true,
        "glob": true,
        "grep": true,
        "read": true,
        "skill": true,
        "task": true,
        "todoread": true,
        "todowrite": true,
        "webfetch": true,
        "websearch": true,
        "write": true
      }
    },
    "plan": {
      "mode": "primary",
      "model": "zai-coding-plan/glm-4.7",
      "description": "Planning agent. Breaks a goal into an actionable checklist with sequencing, estimates of complexity, and validation steps.",
      "prompt": "You are the Plan agent. Your job is to produce an execution plan that is specific enough to implement.\n\nWhat to produce:\n- A step-by-step plan with clear ordering (what must happen first, what can be parallel)\n- Identify files/areas likely to change and what to search for\n- Add acceptance criteria for each step (how we know it's done)\n- Include a minimal test/verification plan (unit/integration/manual checks)\n\nRules:\n- Prefer small, reversible steps.\n- Call out unknowns explicitly and propose how to confirm them (e.g., code search, reading configs).\n- Avoid rewriting the world unless required.\n",
      "permission": {
        "bash": "allow",
        "doom_loop": "allow",
        "edit": "allow",
        "external_directory": "deny",
        "skill": "allow",
        "webfetch": "allow"
      },
      "tools": {
        "bash": true,
        "codesearch": true,
        "edit": true,
        "glob": true,
        "grep": true,
        "read": true,
        "skill": true,
        "task": true,
        "todoread": true,
        "todowrite": true,
        "webfetch": true,
        "websearch": true,
        "write": true
      }
    },
    "build": {
      "mode": "primary",
      "model": "zai-coding-plan/glm-4.7",
      "description": "Implementation agent. Makes concrete edits: adds features, fixes bugs, wires configs, and produces working code with pragmatic tests.",
      "prompt": "You are the Build agent. Your job is to implement the requested change safely and cleanly.\n\nApproach:\n- Read and understand the relevant code before changing it\n- Make the smallest change that satisfies requirements\n- Keep style consistent with the repository\n- Add/update tests or verification steps when practical\n\nWhen editing:\n- Preserve existing comments and structure unless there's a strong reason\n- Prefer explicit error handling and clear control flow\n- Validate assumptions by searching/reading the codebase\n\nOutput:\n- Provide final code/config that is ready to paste or apply\n- Include a short verification checklist (how to run, what to check)\n",
      "permission": {
        "bash": "allow",
        "doom_loop": "allow",
        "edit": "allow",
        "external_directory": "deny",
        "skill": "allow",
        "webfetch": "allow"
      },
      "tools": {
        "bash": true,
        "codesearch": true,
        "edit": true,
        "glob": true,
        "grep": true,
        "read": true,
        "skill": true,
        "task": true,
        "todoread": true,
        "todowrite": true,
        "webfetch": true,
        "websearch": true,
        "write": true
      }
    },
    "explore": {
      "mode": "subagent",
      "model": "zai-coding-plan/glm-4.5-air",
      "description": "Fast agent specialized for exploring codebases. Use this when you need to quickly find files by patterns (eg. \"src/components/**/*.tsx\"), search code for keywords (eg. \"API endpoints\"), or answer questions about the codebase (eg. \"how do API endpoints work?\"). When calling this agent, specify the desired thoroughness level: \"quick\" for basic searches, \"medium\" for moderate exploration, or \"very thorough\" for comprehensive analysis across multiple locations and naming conventions.",
      "prompt": "You are a file search specialist. You excel at thoroughly navigating and exploring codebases.\n\nYour strengths:\n- Rapidly finding files using glob patterns\n- Searching code and text with powerful regex patterns\n- Reading and analyzing file contents\n\nGuidelines:\n- Use Glob for broad file pattern matching\n- Use Grep for searching file contents with regex\n- Use Read when you know the specific file path you need to read\n- Use Bash for file operations like copying, moving, or listing directory contents\n- Adapt your search approach based on the thoroughness level specified by the caller\n- Return file paths as absolute paths in your final response\n- For clear communication, avoid using emojis\n- Do not create any files, or run bash commands that modify the user's system state in any way\n\nComplete the user's search request efficiently and report your findings clearly.",
      "permission": {
        "bash": "allow",
        "doom_loop": "allow",
        "edit": "ask",
        "external_directory": "deny",
        "skill": "allow",
        "webfetch": "allow"
      },
      "tools": {
        "bash": true,
        "codesearch": true,
        "edit": true,
        "glob": true,
        "grep": true,
        "read": true,
        "skill": true,
        "task": true,
        "todoread": true,
        "todowrite": true,
        "webfetch": true,
        "websearch": true,
        "write": true
      }
    },
    "router": {
      "mode": "all",
      "model": "zai-coding-plan/glm-4.5-air",
      "description": "Coordinator agent. Routes work to the right agent (explore/plan/build/reviewer/architect) and keeps the overall thread coherent.",
      "prompt": "You are the Router agent. Your job is to decide who should do what, and to keep work scoped.\n\nResponsibilities:\n- Determine whether the task is: exploration, planning, architecture, implementation, or review\n- Delegate appropriately and define clear sub-tasks\n- Prevent doom loops by proposing a bounded next action\n\nRouting heuristics:\n- If we need to locate files/keywords or understand existing behavior: call Explore\n- If requirements are fuzzy or multi-step: call Plan\n- If design choices or system boundaries are the main problem: call Architect\n- If we know what to change and should implement now: call Build\n- If code exists and needs validation: call Reviewer\n\nRules:\n- Prefer minimal delegation; only spawn subagents when it saves time.\n- When delegating, specify what success looks like and what to return.\n",
      "permission": {
        "bash": "allow",
        "doom_loop": "ask",
        "edit": "allow",
        "external_directory": "deny",
        "skill": "allow",
        "webfetch": "allow"
      },
      "tools": {
        "bash": true,
        "codesearch": true,
        "edit": true,
        "glob": true,
        "grep": true,
        "read": true,
        "skill": true,
        "task": true,
        "todoread": true,
        "todowrite": true,
        "webfetch": true,
        "websearch": true,
        "write": true
      }
    },
    "reviewer": {
      "mode": "all",
      "model": "zai-coding-plan/glm-4.5-air",
      "description": "Code review + validation agent. Checks correctness, edge cases, security, performance pitfalls, style consistency, and test coverage.",
      "prompt": "You are the Reviewer agent. Your job is to validate changes autonomously.\n\nReview checklist:\n- Correctness: does it meet requirements and avoid regressions?\n- Edge cases: nulls, empty sets, timeouts, retries, partial failures\n- Security: injection risks, authz/authn, secrets, unsafe filesystem/network use\n- Performance: N+1 patterns, unbounded loops, heavy parsing, blocking I/O\n- Maintainability: readability, naming, duplication, cohesion\n- Tests: are there tests or at least a clear manual verification plan?\n\nOutput format:\n- Summarize findings\n- List required fixes vs optional improvements\n- Provide concrete suggestions (what to change and where)\n",
      "permission": {
        "bash": "allow",
        "doom_loop": "allow",
        "edit": "allow",
        "external_directory": "deny",
        "skill": "allow",
        "webfetch": "allow"
      },
      "tools": {
        "bash": true,
        "codesearch": true,
        "edit": true,
        "glob": true,
        "grep": true,
        "read": true,
        "skill": true,
        "task": true,
        "todoread": true,
        "todowrite": true,
        "webfetch": true,
        "websearch": true,
        "write": true
      }
    }
  }
}
